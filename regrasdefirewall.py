from scapy.all import *
conf.verb = 0
host = "IP do destino"
portas = [22,80,666,123456789]
pacote = IP(dst=host) / TCP(dport=portas, flags="S")
ans,unans = sr(pacote, inter=0.1, timeout=1)
print "PORTA\tESTADO"
for pr in ans:                             #PACOTE RECEBIDO
    if pr[1].haslayer("ICMP"):
        if pr[1]["ICMP"].type == 3 \and pr [1]["ICMP"].code ==3:
            print pr[0][TCP].dport, "\tREJECT"
        elif pr[1].haslayer("TCP"):
            print pr[1][TCP].sport, "\t", \ pr[1][TCP].sprintf(%flags%)
for pnr in unans:
    print pnr.dport, "\tDROP"               #PACOTE N RECEBIDO
            