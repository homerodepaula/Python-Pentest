from scapy.all import *
conf.verb = 0
portas = [443, 8080, 80, 20, 21, 22, 23, 25, 53, 80, 110, 119, 143, 161] # 80 = FTP /20 = SSH/etc ..TELNET/SMTP/DNS/HTTP/POP3/NNTP/IMAP/SNMP
pacoteIP = IP(dst = "IP do destino")
pacoteTCP = TCP(dport=portas, flag="S")
pacote = pacoteIP/pacoteTCP
ans,unans = sr(pacote, inter=0.1, timeout=1)
print "Porta\tEstado"
for pr in ans:                                  #pacote recebido
    print pr[1][IP].sport, \
    "\t", pr[1][TCP].sprintf("%flags%")